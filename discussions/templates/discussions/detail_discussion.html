{% extends 'base/base.html' %}

{% block head %}
    <title>Обсуждение: {{ discussion.name }}</title>
    {% load static %}
    <link href="{% static '/discussions/css/discussion.css' %}" rel="stylesheet" type="text/css">
    <script defer src="{%  static '/discussions/js/discussion.js' %}"></script>
    <script>
        window.user_pk = {{ user.pk }};
        window.username = '{{ user.username }}';
        window.discussion_id = {{ discussion.pk }};
    </script>
{% endblock %}

{% block main %}
    <main class="discussion">
        <div class="discussion__wrapper">
            <h2 class="discussion__heading">
                {{ discussion.name }}
            </h2>

            <div class="discussion__container">
                <div class="discussion__members">

                    <h2 class="discussion__heading">
                        Список участников
                    </h2>
                    <div class="discussion__container_hiden">
                        {% for user in participants %}
                            <div class="discussion__item">
                                <a>
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <circle cx="8" cy="8" r="7.25" stroke="black" stroke-width="1.5"/>
                                        <mask id="path-2-inside-1_194_19" fill="white">
                                        <path fill-rule="evenodd" clip-rule="evenodd" d="M1.82861 13.0909C3.29595 11.2031 5.51573 10 7.99999 10C10.4843 10 12.7041 11.2031 14.1714 13.0909C12.7041 14.8677 10.4843 16 8.00004 16C5.51575 16 3.29595 14.8676 1.82861 13.0909Z"/>
                                        </mask>
                                        <path d="M1.82861 13.0909L1.03907 12.4772L0.547327 13.1098L1.05756 13.7277L1.82861 13.0909ZM14.1714 13.0909L14.9425 13.7277L15.4527 13.1099L14.961 12.4773L14.1714 13.0909ZM2.61815 13.7046C3.9127 12.0391 5.85059 11 7.99999 11V9C5.18087 9 2.6792 10.3671 1.03907 12.4772L2.61815 13.7046ZM7.99999 11C10.1494 11 12.0873 12.0391 13.3819 13.7046L14.961 12.4773C13.3208 10.3672 10.8191 9 7.99999 9V11ZM13.4004 12.4542C12.1149 14.0107 10.1734 15 8.00004 15V17C10.7952 17 13.2933 15.7246 14.9425 13.7277L13.4004 12.4542ZM8.00004 15C5.82665 15 3.88517 14.0107 2.59966 12.4541L1.05756 13.7277C2.70672 15.7246 5.20486 17 8.00004 17V15Z" fill="black" mask="url(#path-2-inside-1_194_19)"/>
                                        <circle cx="8" cy="6" r="2.5" stroke="black"/>
                                    </svg>
                                    <p>
                                        {{ user.username }}
                                    </p>
                                </a>
                            </div>
                        {% endfor %}
                    </div>
                </div>
                <div class="discussion__messages">
                    <div class="discussion__message">
                        <div class="discussion__message-wrapper">
                            {% for mgs in messages %}
                                <div class="discussion__message-item-{% if mgs.created_user == user %}send{% else %}come{% endif %}">
                                    <div class="discussion__message-item discussion__message-item_{% if mgs.created_user == user %}send{% else %}come{% endif %}">
                                        <p class="discussion__message-text">{{ mgs.body }}</p>
                                        <div class="discussion__message-container">
                                            <span class="discussion__message-name"> {{ mgs.created_user.username }} </span>
                                            <span class="discussion__message-date"> {{ mgs.create_date|date:"d.m.Y" }}</span>
                                        </div>
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                    <div class="discussion__message-container-input">
                        <div class="discussion__message-input">
                            <input type="text" name="" id="" placeholder="Введите текст">
                            <div class="discussion__message-send">
                                <div class="discussion__message-img">
                                    <svg width="31" height="20" viewBox="0 0 31 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M0.5 1L30.1482 9.52246" stroke="black"/>
                                        <line x1="5" y1="9.5" x2="30" y2="9.5" stroke="black"/>
                                        <line x1="0.437079" y1="0.757179" x2="5.43708" y2="9.75718" stroke="black"/>
                                        <path d="M1 19L29.8588 9.49344" stroke="black"/>
                                        <line y1="-0.5" x2="24.5425" y2="-0.5" transform="matrix(0.999993 -0.00375321 -0.00375322 -0.999993 5.18152 9.10413)" stroke="black"/>
                                        <line y1="-0.5" x2="11.0709" y2="-0.5" transform="matrix(0.440001 -0.897997 -0.850372 -0.526182 0.310303 19.0458)" stroke="black"/>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="discussion__files">
                    <h2 class="discussion__heading">
                        Список файлов
                    </h2>
                    <div class="discussion__container_hiden">
                        {% for file in attached_file %}
                            <div class="discussion__item">
                                <a href="{% url 'attached_file:download_file' pk=file.pk %}" target="_blank">
                                    <svg width="15" height="18" viewBox="0 0 15 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <mask id="path-1-inside-1_195_13" fill="white">
                                        <path d="M5.83337 0H12C13.6569 0 15 1.34315 15 3V15C15 16.6569 13.6569 18 12 18H5.83337V0Z"/>
                                        </mask>
                                        <path d="M5.83337 -1H12C14.2092 -1 16 0.790861 16 3H14C14 1.89543 13.1046 1 12 1H5.83337V-1ZM16 15C16 17.2091 14.2092 19 12 19H5.83337V17H12C13.1046 17 14 16.1046 14 15H16ZM5.83337 18V0V18ZM12 -1C14.2092 -1 16 0.790861 16 3V15C16 17.2091 14.2092 19 12 19V17C13.1046 17 14 16.1046 14 15V3C14 1.89543 13.1046 1 12 1V-1Z" fill="#4282C4" mask="url(#path-1-inside-1_195_13)"/>
                                        <path d="M0.521397 5.76087C0.772159 2.84412 3.19629 0.548375 6.16667 0.500755V5.76087H0.521397Z" fill="#4282C4" stroke="#4282C4"/>
                                        <mask id="path-4-inside-2_195_13" fill="white">
                                        <path d="M0 6.26086H5.83333V18H2C0.895432 18 0 17.1046 0 16V6.26086Z"/>
                                        </mask>
                                        <path d="M0 6.26086H5.83333H0ZM5.83333 19H2C0.343146 19 -1 17.6568 -1 16H1C1 16.5523 1.44772 17 2 17H5.83333V19ZM2 19C0.343146 19 -1 17.6568 -1 16V6.26086H1V16C1 16.5523 1.44772 17 2 17V19ZM5.83333 6.26086V18V6.26086Z" fill="#4282C4" mask="url(#path-4-inside-2_195_13)"/>
                                        </svg>
                                    <p>
                                        {{ file.file_name }}
                                    </p>
                                </a>
                            </div>
                        {% endfor %}
                    </div>
                    <div class="discussion__upload">
                        <label for="upload">
                            <div>
                                <svg width="23" height="22" viewBox="0 0 23 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <mask id="path-1-inside-1_195_6" fill="white">
                                    <ellipse cx="11.5" cy="11" rx="11.5" ry="11"/>
                                    </mask>
                                    <path d="M2 11C2 4.60719 7.14281 1 11.5 1V43C28.5597 43 44 29.5431 44 11H2ZM11.5 1C15.8572 1 21 4.60719 21 11H-21C-21 29.5431 -5.55974 43 11.5 43V1ZM21 11C21 17.3928 15.8572 21 11.5 21V-21C-5.55974 -21 -21 -7.54308 -21 11H21ZM11.5 21C7.14281 21 2 17.3928 2 11H44C44 -7.54308 28.5597 -21 11.5 -21V21Z" fill="black" mask="url(#path-1-inside-1_195_6)"/>
                                    <line x1="11.5" y1="5" x2="11.5" y2="16" stroke="black" stroke-width="3"/>
                                    <line x1="6" y1="10.5" x2="17" y2="10.5" stroke="black" stroke-width="3"/>
                                </svg>
                            </div>
                        </label>
                        <input type="file" id="upload">
                        <div class="discussion__save-file">
                            <svg width="17" height="25" viewBox="0 0 17 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <rect x="0.5" y="7.57141" width="16" height="16" rx="1.5" stroke="black"/>
                                <rect x="6.07141" y="3.42859" width="4.85714" height="8.5" fill="#B4D9F3"/>
                                <path d="M8.85355 0.646439C8.65829 0.451177 8.34171 0.451177 8.14645 0.646439L4.96447 3.82842C4.7692 4.02368 4.7692 4.34026 4.96447 4.53553C5.15973 4.73079 5.47631 4.73079 5.67157 4.53553L8.5 1.7071L11.3284 4.53553C11.5237 4.73079 11.8403 4.73079 12.0355 4.53553C12.2308 4.34026 12.2308 4.02368 12.0355 3.82842L8.85355 0.646439ZM9 16.7857L9 0.999992H8L8 16.7857H9Z" fill="black"/>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

{% endblock %}